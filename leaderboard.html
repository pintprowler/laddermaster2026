<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LadderMaster 26 • Prototype</title>

  <!-- Pixel font (optional but highly recommended) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root{
      /* SNES-ish palette inspired by your logo */
      --sky1:#2f7cff;
      --sky2:#2b4fd6;
      --night:#10162b;

      --panel:#0d1326cc;
      --panel2:#0b1022cc;

      --white:#ffffff;
      --ink:#05060a;
      --muted: rgba(255,255,255,.75);

      --green:#03be6c;
      --yellow:#efe300;
      --red:#bb1726;

      --border:#0a0c12;
      --border2: rgba(255,255,255,.14);

      --shadow: 0 18px 55px rgba(0,0,0,.55);
      --radius: 14px;
    }

    *{ box-sizing: border-box; }

    body{
      margin:0;
      color: var(--white);
      background:
        radial-gradient(900px 520px at 18% 8%, rgba(255,255,255,.20), transparent 58%),
        radial-gradient(900px 520px at 82% 12%, rgba(255,255,255,.16), transparent 60%),
        linear-gradient(180deg, var(--sky1) 0%, var(--sky2) 45%, var(--night) 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Subtle CRT scanlines */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: .12;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,.22) 0px,
        rgba(0,0,0,.22) 1px,
        rgba(255,255,255,.02) 2px,
        rgba(255,255,255,.02) 3px
      );
      mix-blend-mode: overlay;
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* Retro title/font areas */
    .pix, .pix *{
      font-family: "Press Start 2P", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      letter-spacing: .6px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width: 260px;
    }

    .logo{
      width: 56px;
      height: 56px;
      border-radius: 10px;
      border: 4px solid var(--ink);
      background: rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      overflow: hidden;
      display:grid;
      place-items:center;
    }
    .logo img{
      width:100%;
      height:100%;
      object-fit: cover;
      image-rendering: pixelated; /* key for your SNES vibe */
      display:block;
    }
    .logo-fallback{
      color: var(--yellow);
      font-weight: 900;
      font-size: 14px;
    }

    .title{
      line-height: 1.25;
    }
    .title h1{
      margin: 0;
      font-size: 14px;
    }
    .title .sub{
      margin-top: 6px;
      font-size: 11px;
      opacity: .85;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      letter-spacing: 0;
    }

    .btn{
      border: 4px solid var(--ink);
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06));
      color: var(--white);
      padding: 10px 12px;
      cursor: pointer;
      box-shadow: 0 10px 0 rgba(0,0,0,.35), var(--shadow);
      transform: translateY(0);
      transition: transform .06s ease;
      font-weight: 800;
    }
    .btn:active{
      transform: translateY(3px);
      box-shadow: 0 7px 0 rgba(0,0,0,.35), var(--shadow);
    }

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 14px;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    /* Pixel-ish panels */
    .panel{
      border: 4px solid var(--ink);
      border-radius: var(--radius);
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
    }

    .panel .hd{
      padding: 12px 12px 10px;
      border-bottom: 4px solid var(--ink);
      background: rgba(0,0,0,.25);
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
      align-items: baseline;
    }

    .panel .hd .h{
      font-size: 12px;
    }

    .hint{
      font-size: 11px;
      opacity: .85;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      letter-spacing: 0;
    }

    table{
      width: 100%;
      border-collapse: collapse;
    }
    th, td{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      vertical-align: top;
    }
    th{
      font-size: 10px;
      opacity: .8;
      text-transform: uppercase;
      letter-spacing: .12em;
    }
    td.right, th.right{ text-align:right; }

    tr.click{
      cursor: pointer;
    }
    tr.click:hover{
      background: rgba(255,255,255,.06);
    }
    tr.active{
      background: rgba(239,227,0,.12);
      outline: 2px solid rgba(239,227,0,.30);
      outline-offset: -2px;
    }

    .tabs{
      display:flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
    }
    .tab{
      border: 3px solid var(--ink);
      border-radius: 999px;
      padding: 8px 10px;
      background: rgba(255,255,255,.08);
      color: var(--white);
      cursor: pointer;
      box-shadow: 0 6px 0 rgba(0,0,0,.30);
      font-weight: 900;
      font-size: 11px;
    }
    .tab.active{
      background: rgba(3,190,108,.18);
      box-shadow: 0 6px 0 rgba(0,0,0,.30), 0 0 0 2px rgba(3,190,108,.35) inset;
    }
    .tab:active{ transform: translateY(2px); }

    /* Mobile: horizontal scroll for wide breakdown */
    .table-scroll{
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    .table-scroll table{
      min-width: 760px;
    }

    /* Heat pills (simple + punchy) */
    .heat{
      display:inline-flex;
      justify-content:center;
      min-width: 44px;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 900;
      border: 2px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.07);
    }
    .p10{ border-color: rgba(3,190,108,.55); background: rgba(3,190,108,.22); }
    .p5{ border-color: rgba(3,190,108,.35); background: rgba(3,190,108,.14); }
    .p4{ border-color: rgba(3,190,108,.30); background: rgba(3,190,108,.12); }
    .p3{ border-color: rgba(239,227,0,.40); background: rgba(239,227,0,.14); color: rgba(255,255,255,.95); }
    .p2{ border-color: rgba(239,227,0,.30); background: rgba(239,227,0,.10); }
    .p1{ border-color: rgba(187,23,38,.35); background: rgba(187,23,38,.14); }
    .p0{ opacity: .70; }

    .footer{
      padding: 10px 12px 12px;
      font-size: 12px;
      opacity: .85;
      border-top: 1px solid rgba(255,255,255,.10);
    }
    .footer code{
      color: var(--yellow);
      font-weight: 900;
    }

    /* Little “sparkles” for fun (lightweight) */
    .spark{
      position:absolute;
      width: 6px;
      height: 6px;
      background: rgba(255,255,255,.85);
      border-radius: 2px;
      box-shadow: 0 0 14px rgba(255,255,255,.35);
      opacity: .35;
      animation: twinkle 2.8s infinite ease-in-out;
    }
    .s1{ top: 16px; right: 18px; animation-delay: .1s; }
    .s2{ top: 52px; right: 54px; animation-delay: .9s; }
    .s3{ top: 26px; right: 84px; animation-delay: 1.7s; }
    @keyframes twinkle{
      0%, 100%{ transform: scale(1); opacity: .25; }
      50%{ transform: scale(1.35); opacity: .55; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logo">
          <img src="./logo.png" alt="Logo" onerror="this.remove(); document.getElementById('logoFallback').style.display='block';" />
          <div id="logoFallback" class="logo-fallback" style="display:none;">LM26</div>
        </div>
        <div class="title">
          <div class="pix"><h1>LadderMaster 26</h1></div>
          <div class="sub" id="updatedAt">Last updated: —</div>
        </div>
      </div>

      <button class="btn pix" id="randomizeBtn">NEW SEASON!</button>
    </div>

    <div class="grid">
      <!-- Leaderboard -->
      <div class="panel">
        <div class="spark s1"></div><div class="spark s2"></div><div class="spark s3"></div>
        <div class="hd">
          <div class="pix h">Leaderboard</div>
          <div class="hint">Click a player to view breakdown</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:80px;">Rank</th>
              <th>Player</th>
              <th class="right" style="width:120px;">Points</th>
            </tr>
          </thead>
          <tbody id="leaderboardBody"></tbody>
        </table>
        <div class="footer">
          Scoring: <code>0→10</code>, <code>1→5</code>, <code>2→4</code>, <code>3→3</code>, <code>4→2</code>, <code>5→1</code>, <code>6+→0</code>
        </div>
      </div>

      <!-- Current ladder -->
      <div class="panel">
        <div class="hd">
          <div class="pix h">Current Ladder</div>
          <div class="hint">Dummy ladder for prototyping</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:80px;">Pos</th>
              <th>Team</th>
            </tr>
          </thead>
          <tbody id="ladderBody"></tbody>
        </table>
        <div class="footer">
          Later: this becomes your weekly update tab in Google Sheets.
        </div>
      </div>

      <!-- Breakdown -->
      <div class="panel" style="grid-column: 1 / -1;">
        <div class="hd">
          <div class="pix h">Player Breakdown</div>
          <div class="hint">On mobile: swipe sideways for all columns</div>
        </div>

        <div class="tabs" id="tabs"></div>

        <div class="table-scroll">
          <table>
            <thead>
              <tr>
                <th>Team</th>
                <th class="right">Pred</th>
                <th class="right">Actual</th>
                <th class="right">Diff</th>
                <th class="right">Pts</th>
              </tr>
            </thead>
            <tbody id="breakdownBody"></tbody>
          </table>
        </div>

        <div class="footer">
          Tip: add <code>logo.png</code> next to <code>index.html</code> in GitHub.
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- Dummy data ---
    const TEAMS = [
      "Adelaide", "Brisbane", "Carlton", "Collingwood", "Essendon", "Fremantle",
      "Geelong", "Gold Coast", "GWS", "Hawthorn", "Melbourne", "North Melbourne",
      "Port Adelaide", "Richmond", "St Kilda", "Sydney", "West Coast", "Western Bulldogs"
    ];

    const PLAYERS = ["Jason", "Sam", "Alex", "Taylor", "Maddy", "Chris"];

    // --- Scoring (your exact breakdown) ---
    function scoreForDiff(diff){
      if (diff === 0) return 10;
      if (diff === 1) return 5;
      if (diff === 2) return 4;
      if (diff === 3) return 3;
      if (diff === 4) return 2;
      if (diff === 5) return 1;
      return 0;
    }

    // --- Helpers ---
    function shuffle(arr){
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function nowStamp(){
      return new Date().toLocaleString();
    }

    function heatClass(points){
      if (points === 10) return "heat p10";
      if (points === 5) return "heat p5";
      if (points === 4) return "heat p4";
      if (points === 3) return "heat p3";
      if (points === 2) return "heat p2";
      if (points === 1) return "heat p1";
      return "heat p0";
    }

    // --- Generate dummy "actual ladder" ---
    function generateActualLadder(){
      const order = shuffle(TEAMS);
      const ladder = {};
      order.forEach((team, idx) => ladder[team] = idx + 1);
      return ladder;
    }

    // --- Generate dummy player predictions (realistic-ish) ---
    function generatePredictions(actualLadder){
      const actualOrder = TEAMS.slice().sort((a,b)=>actualLadder[a]-actualLadder[b]);

      function perturb(order, intensity){
        const a = [...order];
        for (let k = 0; k < intensity; k++){
          const i = Math.floor(Math.random() * a.length);
          const j = Math.max(0, Math.min(a.length - 1, i + (Math.random() < 0.5 ? -1 : 1)));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      }

      const predictions = {};
      PLAYERS.forEach((p, idx) => {
        const intensity = 10 + idx * 4;
        const order = perturb(actualOrder, intensity);
        const ranks = {};
        order.forEach((team, i) => ranks[team] = i + 1);
        predictions[p] = ranks;
      });
      return predictions;
    }

    function computeLeaderboard(actualLadder, predictions){
      const leaderboard = PLAYERS.map(name => {
        let total = 0;
        let exact = 0;
        const breakdown = TEAMS.map(team => {
          const pred = predictions[name][team];
          const act = actualLadder[team];
          const diff = Math.abs(pred - act);
          const pts = scoreForDiff(diff);
          total += pts;
          if (diff === 0) exact++;
          return { team, pred, act, diff, pts };
        }).sort((a,b)=>a.act-b.act);
        return { name, total, exact, breakdown };
      }).sort((a,b)=>b.total-a.total);

      return leaderboard;
    }

    // --- DOM ---
    const elUpdatedAt = document.getElementById("updatedAt");
    const elLeaderboardBody = document.getElementById("leaderboardBody");
    const elLadderBody = document.getElementById("ladderBody");
    const elTabs = document.getElementById("tabs");
    const elBreakdownBody = document.getElementById("breakdownBody");
    const elRandomizeBtn = document.getElementById("randomizeBtn");

    let state = {
      actualLadder: null,
      predictions: null,
      leaderboard: null,
      activePlayer: null
    };

    function renderLadder(){
      const order = TEAMS.slice().sort((a,b)=>state.actualLadder[a]-state.actualLadder[b]);
      elLadderBody.innerHTML = order.map(team => `
        <tr>
          <td>${state.actualLadder[team]}</td>
          <td><b>${team}</b></td>
        </tr>
      `).join("");
    }

    function renderLeaderboard(){
      const lb = state.leaderboard || [];
      if (!state.activePlayer && lb.length) state.activePlayer = lb[0].name;

      elLeaderboardBody.innerHTML = lb.map((p, idx) => {
        const isActive = p.name === state.activePlayer;
        return `
          <tr class="click ${isActive ? "active" : ""}" data-player="${p.name}">
            <td>${idx + 1}</td>
            <td>
              <div style="font-weight:900;">${p.name}</div>
              <div style="opacity:.8;font-size:12px;">Exact hits: <b style="color: var(--yellow);">${p.exact}</b></div>
            </td>
            <td class="right" style="font-weight:900;font-size:16px;">${p.total}</td>
          </tr>
        `;
      }).join("");
    }

    function renderTabs(){
      const lb = state.leaderboard || [];
      elTabs.innerHTML = lb.map(p => {
        const active = p.name === state.activePlayer ? "active" : "";
        return `<button class="tab ${active} pix" data-tab="${p.name}">${p.name}</button>`;
      }).join("");
    }

    function renderBreakdown(){
      const lb = state.leaderboard || [];
      const player = lb.find(p => p.name === state.activePlayer) || lb[0];
      if (!player){
        elBreakdownBody.innerHTML = `<tr><td colspan="5">No players.</td></tr>`;
        return;
      }

      elBreakdownBody.innerHTML = player.breakdown.map(r => `
        <tr>
          <td><b>${r.team}</b></td>
          <td class="right">${r.pred}</td>
          <td class="right">${r.act}</td>
          <td class="right">${r.diff}</td>
          <td class="right"><span class="${heatClass(r.pts)}">${r.pts}</span></td>
        </tr>
      `).join("");
    }

    function renderAll(){
      elUpdatedAt.textContent = "Last updated: " + nowStamp();
      renderLadder();
      renderLeaderboard();
      renderTabs();
      renderBreakdown();
    }

    function regenerate(){
      state.actualLadder = generateActualLadder();
      state.predictions = generatePredictions(state.actualLadder);
      state.leaderboard = computeLeaderboard(state.actualLadder, state.predictions);
      state.activePlayer = state.leaderboard[0]?.name ?? null;
      renderAll();
    }

    // Click leaderboard row
    document.addEventListener("click", (e) => {
      const row = e.target.closest("[data-player]");
      if (row){
        state.activePlayer = row.getAttribute("data-player");
        renderLeaderboard();
        renderTabs();
        renderBreakdown();
        return;
      }
      const tab = e.target.closest("[data-tab]");
      if (tab){
        state.activePlayer = tab.getAttribute("data-tab");
        renderLeaderboard();
        renderTabs();
        renderBreakdown();
        return;
      }
    });

    elRandomizeBtn.addEventListener("click", regenerate);

    regenerate();
  </script>
</body>
</html>
