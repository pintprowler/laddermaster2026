<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AFL 2026 Ladder Prediction • Prototype</title>

  <style>
    /* --- Palette (your picks) --- */
    :root{
      --c1:#202a37;
      --c2:#202836;
      --c3:#10162b;
      --green:#03be6c;
      --yellow:#efe300;
      --red:#bb1726;

      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --border: rgba(255,255,255,.10);
      --shadow: 0 16px 50px rgba(0,0,0,.45);
      --radius: 18px;
    }

    /* --- Background --- */
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(3,190,108,.20), transparent 60%),
        radial-gradient(900px 600px at 85% 18%, rgba(239,227,0,.12), transparent 60%),
        radial-gradient(800px 600px at 60% 95%, rgba(187,23,38,.14), transparent 60%),
        linear-gradient(180deg, var(--c3), #0b1022 65%, #070b16);
      min-height:100vh;
    }

    .wrap{ max-width: 1150px; margin: 0 auto; padding: 22px; }
    .topbar{
      display:flex; align-items:center; justify-content:space-between; gap:14px; flex-wrap:wrap;
      margin-bottom: 18px;
    }
    .brand{ display:flex; align-items:center; gap:12px; }
    .logo{
      width:44px; height:44px; border-radius: 12px;
      background: linear-gradient(135deg, rgba(3,190,108,.25), rgba(239,227,0,.18));
      border: 1px solid var(--border);
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      overflow:hidden;
      display:grid; place-items:center;
    }
    .logo img{ width:100%; height:100%; object-fit:cover; display:block; }
    .logo-fallback{
      font-weight:900; letter-spacing:.5px; color: var(--yellow);
      text-shadow: 0 0 18px rgba(239,227,0,.25);
      font-size: 16px;
    }

    h1{ margin:0; font-size: 20px; letter-spacing: .2px; }
    .sub{ margin-top:4px; color: var(--muted); font-size: 13px; }

    .btn{
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: rgba(32,42,55,.55);
      color: var(--text);
      cursor:pointer;
      box-shadow: 0 10px 28px rgba(0,0,0,.25);
      transition: transform .08s ease, border-color .2s ease, background .2s ease;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(3,190,108,.35); background: rgba(32,42,55,.70); }
    .btn:active{ transform: translateY(0px); }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 16px;
    }
    @media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

    .card{
      background: linear-gradient(180deg, rgba(32,40,54,.70), rgba(32,42,55,.55));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding: 14px 16px;
      display:flex; justify-content:space-between; align-items:baseline; gap:10px; flex-wrap:wrap;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(16,22,43,.35);
    }
    .title{ font-weight: 800; letter-spacing:.2px; }
    .hint{ color: var(--muted); font-size: 12px; }

    table{ width:100%; border-collapse: collapse; }
    th, td{ padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,.07); }
    th{ text-align:left; color: rgba(255,255,255,.78); font-size: 12px; text-transform: uppercase; letter-spacing: .10em; }
    td.right, th.right{ text-align:right; }

    tr.click{ cursor:pointer; }
    tr.click:hover{ background: rgba(3,190,108,.08); }
    tr.active{ background: rgba(3,190,108,.13); }

    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(16,22,43,.35);
      color: rgba(255,255,255,.82);
      font-size: 12px;
    }
    .dot{ width:8px; height:8px; border-radius:999px; background: var(--green); box-shadow: 0 0 18px rgba(3,190,108,.25); }
    .dot.yellow{ background: var(--yellow); box-shadow: 0 0 18px rgba(239,227,0,.20); }
    .dot.red{ background: var(--red); box-shadow: 0 0 18px rgba(187,23,38,.20); }

    .tabs{
      display:flex; flex-wrap:wrap; gap:8px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(16,22,43,.25);
    }
    .tab{
      border-radius: 999px;
      padding: 8px 11px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(32,42,55,.50);
      color: rgba(255,255,255,.85);
      cursor:pointer;
      font-weight: 650;
      transition: border-color .2s ease, transform .08s ease, background .2s ease;
    }
    .tab:hover{ transform: translateY(-1px); border-color: rgba(239,227,0,.35); }
    .tab.active{
      background: rgba(239,227,0,.14);
      border-color: rgba(239,227,0,.35);
      color: #fff;
    }

    .legend{ display:flex; gap:10px; flex-wrap:wrap; padding: 12px 14px; color: var(--muted); font-size: 12px; }
    .footer{ margin-top: 16px; color: var(--muted); font-size: 12px; }
    code.k{ color: rgba(239,227,0,.85); }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logo">
          <!-- Put your logo file in the repo as /logo.png -->
          <img src="./logo.png" alt="Site Logo" onerror="this.remove(); document.getElementById('logoFallback').style.display='grid';" />
          <div id="logoFallback" class="logo-fallback" style="display:none;">AFL</div>
        </div>
        <div>
          <h1>AFL 2026 Ladder Prediction <span style="opacity:.7;font-weight:700;">• Prototype</span></h1>
          <div class="sub" id="updatedAt">Last updated: —</div>
        </div>
      </div>

      <button class="btn" id="randomizeBtn">Regenerate Dummy Ladder</button>
    </div>

    <div class="grid">
      <!-- Leaderboard -->
      <div class="card">
        <div class="hd">
          <div class="title">Leaderboard</div>
          <div class="hint">Click a player to view breakdown</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:80px;">Rank</th>
              <th>Player</th>
              <th class="right">Total</th>
            </tr>
          </thead>
          <tbody id="leaderboardBody"></tbody>
        </table>
        <div class="legend">
          <span class="pill"><span class="dot"></span>Best overall</span>
          <span class="pill"><span class="dot yellow"></span>In the hunt</span>
          <span class="pill"><span class="dot red"></span>Needs a miracle</span>
        </div>
      </div>

      <!-- Current ladder -->
      <div class="card">
        <div class="hd">
          <div class="title">Current Ladder (Dummy)</div>
          <div class="hint">This is what you’ll update weekly later</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:80px;">Pos</th>
              <th>Team</th>
            </tr>
          </thead>
          <tbody id="ladderBody"></tbody>
        </table>
        <div class="footer" style="padding: 12px 14px;">
          Scoring: <code class="k">0→10</code>, <code class="k">1→5</code>, <code class="k">2→4</code>, <code class="k">3→3</code>, <code class="k">4→2</code>, <code class="k">5→1</code>, <code class="k">6+→0</code>
        </div>
      </div>

      <!-- Breakdown -->
      <div class="card" style="grid-column: 1 / -1;">
        <div class="hd">
          <div class="title">Player Breakdown</div>
          <div class="hint">Team-by-team scoring</div>
        </div>

        <div class="tabs" id="tabs"></div>

        <table>
          <thead>
            <tr>
              <th>Team</th>
              <th class="right">Predicted</th>
              <th class="right">Actual</th>
              <th class="right">Diff</th>
              <th class="right">Points</th>
            </tr>
          </thead>
          <tbody id="breakdownBody"></tbody>
        </table>

        <div class="footer" style="padding: 12px 14px;">
          Next step later: replace dummy data with your Google Sheets / Apps Script API.
        </div>
      </div>
    </div>
  </div>

  <script>
    // -----------------------------
    // Dummy data (AFL teams)
    // -----------------------------
    const TEAMS = [
      "Adelaide", "Brisbane", "Carlton", "Collingwood", "Essendon", "Fremantle",
      "Geelong", "Gold Coast", "GWS", "Hawthorn", "Melbourne", "North Melbourne",
      "Port Adelaide", "Richmond", "St Kilda", "Sydney", "West Coast", "Western Bulldogs"
    ];

    // Players (dummy)
    const PLAYERS = ["Jason", "Sam", "Alex", "Taylor", "Maddy", "Chris"];

    // -----------------------------
    // Scoring (your exact breakdown)
    // -----------------------------
    function scoreForDiff(diff){
      if (diff === 0) return 10;
      if (diff === 1) return 5;
      if (diff === 2) return 4;
      if (diff === 3) return 3;
      if (diff === 4) return 2;
      if (diff === 5) return 1;
      return 0;
    }

    // -----------------------------
    // Helpers
    // -----------------------------
    function shuffle(arr){
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function nowStamp(){
      return new Date().toLocaleString();
    }

    // Generate dummy "actual ladder" (random order)
    function generateActualLadder(){
      const order = shuffle(TEAMS);
      const ladder = {};
      order.forEach((team, idx) => ladder[team] = idx + 1);
      return ladder;
    }

    // Generate dummy player predictions:
    // start from actual ladder and apply random small swaps so it feels realistic.
    function generatePredictions(actualLadder){
      const actualOrder = TEAMS.slice().sort((a,b)=>actualLadder[a]-actualLadder[b]);

      function perturb(order, intensity){
        const a = [...order];
        for (let k = 0; k < intensity; k++){
          const i = Math.floor(Math.random() * a.length);
          const j = Math.max(0, Math.min(a.length - 1, i + (Math.random() < 0.5 ? -1 : 1)));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      }

      // Each player gets a slightly different intensity
      const predictions = {};
      PLAYERS.forEach((p, idx) => {
        const intensity = 10 + idx * 4; // tweak to taste
        const order = perturb(actualOrder, intensity);

        // convert to ranks: team -> predicted position
        const ranks = {};
        order.forEach((team, i) => ranks[team] = i + 1);
        predictions[p] = ranks;
      });

      return predictions;
    }

    // Compute leaderboard + breakdown
    function computeScores(actualLadder, predictions){
      const leaderboard = PLAYERS.map(name => {
        let total = 0;
        const breakdown = TEAMS.map(team => {
          const predictedRank = predictions[name][team];
          const actualRank = actualLadder[team];
          const diff = Math.abs(predictedRank - actualRank);
          const points = scoreForDiff(diff);
          total += points;
          return { team, predictedRank, actualRank, diff, points };
        }).sort((a,b)=>a.actualRank-b.actualRank);

        return { name, total, breakdown };
      }).sort((a,b)=>b.total-a.total);

      return leaderboard;
    }

    // -----------------------------
    // Render
    // -----------------------------
    const elUpdatedAt = document.getElementById("updatedAt");
    const elLeaderboardBody = document.getElementById("leaderboardBody");
    const elLadderBody = document.getElementById("ladderBody");
    const elTabs = document.getElementById("tabs");
    const elBreakdownBody = document.getElementById("breakdownBody");
    const elRandomizeBtn = document.getElementById("randomizeBtn");

    let state = {
      actualLadder: null,
      predictions: null,
      leaderboard: null,
      activePlayer: null
    };

    function renderLadder(){
      const order = TEAMS.slice().sort((a,b)=>state.actualLadder[a]-state.actualLadder[b]);
      elLadderBody.innerHTML = order.map(team => `
        <tr>
          <td>${state.actualLadder[team]}</td>
          <td><b>${team}</b></td>
        </tr>
      `).join("");
    }

    function renderLeaderboard(){
      const lb = state.leaderboard;

      if (!state.activePlayer && lb.length) state.activePlayer = lb[0].name;

      elLeaderboardBody.innerHTML = lb.map((p, idx) => {
        const cls = p.name === state.activePlayer ? "active" : "";
        return `
          <tr class="click ${cls}" data-player="${p.name}">
            <td>${idx + 1}</td>
            <td><b>${p.name}</b></td>
            <td class="right">${p.total}</td>
          </tr>
        `;
      }).join("");
    }

    function renderTabs(){
      elTabs.innerHTML = state.leaderboard.map(p => {
        const cls = p.name === state.activePlayer ? "active" : "";
        return `<button class="tab ${cls}" data-player="${p.name}">${p.name}</button>`;
      }).join("");
    }

    function renderBreakdown(){
      const player = state.leaderboard.find(p => p.name === state.activePlayer) || state.leaderboard[0];
      if (!player){
        elBreakdownBody.innerHTML = `<tr><td colspan="5">No players.</td></tr>`;
        return;
      }

      elBreakdownBody.innerHTML = player.breakdown.map(r => `
        <tr>
          <td>${r.team}</td>
          <td class="right">${r.predictedRank}</td>
          <td class="right">${r.actualRank}</td>
          <td class="right">${r.diff}</td>
          <td class="right"><b>${r.points}</b></td>
        </tr>
      `).join("");
    }

    function renderAll(){
      elUpdatedAt.textContent = "Last updated: " + nowStamp();
      renderLadder();
      renderLeaderboard();
      renderTabs();
      renderBreakdown();
    }

    function regenerate(){
      state.actualLadder = generateActualLadder();
      state.predictions = generatePredictions(state.actualLadder);
      state.leaderboard = computeScores(state.actualLadder, state.predictions);
      state.activePlayer = state.leaderboard[0]?.name ?? null;
      renderAll();
    }

    // Click handling
    document.addEventListener("click", (e) => {
      const node = e.target.closest("[data-player]");
      if (!node) return;
      state.activePlayer = node.getAttribute("data-player");
      renderLeaderboard();
      renderTabs();
      renderBreakdown();
    });

    elRandomizeBtn.addEventListener("click", regenerate);

    // Boot
    regenerate();
  </script>
</body>
</html>
